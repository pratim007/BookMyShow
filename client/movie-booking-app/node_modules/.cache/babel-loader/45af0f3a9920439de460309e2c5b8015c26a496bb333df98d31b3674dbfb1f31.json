{"ast":null,"code":"// import { useEffect, useState } from \"react\";\n// import { useNavigate, useParams } from \"react-router-dom\";\n// import { GetShowDetails } from \"../../api/shows\";\n// import Navbar from \"../../components/Navbar\";\n// import { Button, Card, Col, message, Row } from \"antd\";\n// import { all } from \"axios\";\n// // import StripeCheckout from 'react-stripe-checkout';\n// // import { createBooking, makePayment } from \"../../api/bookings\";\n\n// function BookShow(){\n\n//     const params = useParams();\n//     const showId = params.showId;\n\n//     const [showDetails, setShowDetails] = useState(null);\n//     const [selectedSeats, setSelectedSeats] = useState([]);\n\n//     const navigate = useNavigate();\n\n//     useEffect(()=>{\n//         fetchShowData();\n//     },[])\n\n//     const fetchShowData = async ()=>{\n//         try{\n\n//             const showResponse = await GetShowDetails(showId);\n\n//             if(showResponse.success){\n//                 setShowDetails(showResponse.data);\n//             }\n\n//         }catch(err){\n\n//         }\n//     }\n\n//     const onToken = async (token)=>{\n\n//         console.log(\"Token generated \", token.id);\n\n//         try{\n\n//             const paymentsResponse = await makePayment({token:token.id,amount:selectedSeats.length * showDetails.ticketPrice});\n\n//             if(paymentsResponse.success){\n\n//                 message.success(paymentsResponse.message);\n\n//                 const bookingResponse = await createBooking({show:showId,transactionId:paymentsResponse.data,seats:selectedSeats});\n\n//                 if(bookingResponse.success){\n//                     message.success(bookingResponse.message);\n\n//                     setTimeout(()=>{\n//                         navigate(\"/\");\n//                     },1000)\n//                 }\n\n//             }\n\n//         }catch(err){\n\n//         }\n\n//     }\n\n//     const getSeats = ()=>{\n\n//         const totalSeats = showDetails.totalSeats;\n//         const columns = 12;\n\n//         const rows = Math.ceil(totalSeats/columns);\n\n//         //0 to rows-1 \n\n//         let allRows = [];\n\n//         for(let i=0;i<rows;i++){\n//             allRows.push(i);\n//         }\n\n//         let allColumns = [];\n\n//         for(let j=0;j<columns;j++){\n//             allColumns.push(j);\n//         }\n\n//         console.log(allRows);\n//         console.log(allColumns);\n\n//         const handleSeatSelect = (seatNumber)=>{\n\n//             if(!selectedSeats.includes(seatNumber)){\n//                 setSelectedSeats([...selectedSeats, seatNumber]);\n//                 return;\n//             }\n\n//             const updatedSeats = selectedSeats.filter((seat)=>seat!=seatNumber);\n//             setSelectedSeats(updatedSeats);\n\n//         }\n\n//         return <div>\n\n//             <div className=\"seat-ul\">\n//                 {\n//                     allRows.map((row)=>{\n\n//                         return <div className=\"seat-ul\" >\n//                                {\n\n//                                 allColumns.map((col)=>{\n//                                     let seatNumber = row*columns + col + 1;\n//                                     let seatClass = \"seat-btn\";\n\n//                                     if(showDetails.bookedSeats.includes(seatNumber)){\n//                                         seatClass+= \" booked\";\n//                                     }\n\n//                                     if(selectedSeats.includes(seatNumber)){\n//                                         seatClass+= \" selected\"\n//                                     }\n\n//                                     if(seatNumber<=totalSeats){\n//                                     return <button onClick={()=>handleSeatSelect(seatNumber)}  className={seatClass}> {seatNumber} </button>\n//                                     }\n//                                 })\n//                                }\n\n//                             </div>\n\n//                     })\n//                 }\n\n//             </div>\n\n//             <div className=\"bottom-card mt-3 max-width-600 mx-auto\" >\n\n//                 <div> Selected Seats : <span> {selectedSeats.join(\", \")} </span>  </div>\n//                 <div> Total Price : <span> {selectedSeats.length * showDetails.ticketPrice}</span>   </div>\n//             </div>\n\n//         </div>\n\n//     }\n\n//     return <>\n\n//     <Navbar/> \n\n//     {\n//        !showDetails &&  <div className=\"ms-3 pt-3\">\n//        <h2> \n//            Loading Seat View......\n//        </h2>\n//    </div>\n//     }\n\n//     {\n//         showDetails && <div>\n\n//             <Row>\n\n//                 <Col>\n\n//                     <Card\n//         title= {\n\n//             <div>\n//                 <h1> {showDetails.movie.movieName} </h1>\n//                 <p> \n//                    {showDetails.theatre.name}, {showDetails.theatre.address}\n//                 </p>\n//             </div>\n\n//         }\n//         extra={\n//             <div>\n\n//                 <div>\n\n//                     <h4>  Date : {showDetails.showDate}</h4>\n\n//                 </div>\n\n//                 <div>\n\n//                 <h4>   Time : {showDetails.showTime}</h4>\n\n//                 </div>\n\n//                 <div>\n\n//                 <h4>  Ticket Price : Rs.{showDetails.ticketPrice}</h4>\n\n//                 </div>\n\n//                 <div>\n\n//                 <h4>  Total Seats: {showDetails.totalSeats} | Available Seats: \n\n//                    {showDetails.totalSeats - showDetails.bookedSeats.length}  \n\n//                 </h4>\n\n//                 </div>\n\n//             </div>\n\n//         }\n//         style={{\n//             width: \"100vw\",\n//         }}\n//         >\n\n//             {getSeats()}\n\n//         </Card>\n\n//                 </Col>\n\n//             </Row>\n\n//             {/* {\n\n//                 selectedSeats.length >0 && \n//                 <StripeCheckout \n//                 className=\"ms-3\"\n//             token={onToken}\n//             stripeKey=\"pk_test_51R3pTx2XhG8Zyja1v8IF4hAfqxkQzaMRAx7e9qgGerT89sUC6uDtGw0AGNQRGqNl0N51UYqzpyzn62VuyIluiDin00xHInuBQv\"\n\n//         />\n\n//             } */}\n\n//         </div> \n//     }\n\n//     </>\n\n// }\n\n// export default BookShow;\n\n// /*\n\n//  row=3 col=5 \n\n//  row * 12 + col + 1\n\n//  Seat Number = currentRow * TotalCol + currentCol + 1\n\n// */","map":{"version":3,"names":[],"sources":["C:/PRATIM/MovieBookingApp/client/movie-booking-app/src/pages/BookShow/index.js"],"sourcesContent":["// import { useEffect, useState } from \"react\";\r\n// import { useNavigate, useParams } from \"react-router-dom\";\r\n// import { GetShowDetails } from \"../../api/shows\";\r\n// import Navbar from \"../../components/Navbar\";\r\n// import { Button, Card, Col, message, Row } from \"antd\";\r\n// import { all } from \"axios\";\r\n// // import StripeCheckout from 'react-stripe-checkout';\r\n// // import { createBooking, makePayment } from \"../../api/bookings\";\r\n\r\n// function BookShow(){\r\n\r\n//     const params = useParams();\r\n//     const showId = params.showId;\r\n\r\n//     const [showDetails, setShowDetails] = useState(null);\r\n//     const [selectedSeats, setSelectedSeats] = useState([]);\r\n\r\n//     const navigate = useNavigate();\r\n\r\n//     useEffect(()=>{\r\n//         fetchShowData();\r\n//     },[])\r\n\r\n//     const fetchShowData = async ()=>{\r\n//         try{\r\n\r\n//             const showResponse = await GetShowDetails(showId);\r\n\r\n//             if(showResponse.success){\r\n//                 setShowDetails(showResponse.data);\r\n//             }\r\n\r\n//         }catch(err){\r\n\r\n//         }\r\n//     }\r\n\r\n\r\n//     const onToken = async (token)=>{\r\n        \r\n//         console.log(\"Token generated \", token.id);\r\n\r\n//         try{\r\n\r\n//             const paymentsResponse = await makePayment({token:token.id,amount:selectedSeats.length * showDetails.ticketPrice});\r\n\r\n\r\n//             if(paymentsResponse.success){\r\n\r\n//                 message.success(paymentsResponse.message);\r\n\r\n//                 const bookingResponse = await createBooking({show:showId,transactionId:paymentsResponse.data,seats:selectedSeats});\r\n\r\n//                 if(bookingResponse.success){\r\n//                     message.success(bookingResponse.message);\r\n\r\n//                     setTimeout(()=>{\r\n//                         navigate(\"/\");\r\n//                     },1000)\r\n//                 }\r\n\r\n                \r\n\r\n//             }\r\n\r\n//         }catch(err){\r\n\r\n\r\n//         }\r\n\r\n\r\n//     }\r\n\r\n//     const getSeats = ()=>{\r\n\r\n//         const totalSeats = showDetails.totalSeats;\r\n//         const columns = 12;\r\n\r\n//         const rows = Math.ceil(totalSeats/columns);\r\n\r\n\r\n//         //0 to rows-1 \r\n\r\n//         let allRows = [];\r\n\r\n//         for(let i=0;i<rows;i++){\r\n//             allRows.push(i);\r\n//         }\r\n\r\n\r\n//         let allColumns = [];\r\n\r\n//         for(let j=0;j<columns;j++){\r\n//             allColumns.push(j);\r\n//         }\r\n\r\n//         console.log(allRows);\r\n//         console.log(allColumns);\r\n\r\n//         const handleSeatSelect = (seatNumber)=>{\r\n\r\n            \r\n//             if(!selectedSeats.includes(seatNumber)){\r\n//                 setSelectedSeats([...selectedSeats, seatNumber]);\r\n//                 return;\r\n//             }\r\n\r\n//             const updatedSeats = selectedSeats.filter((seat)=>seat!=seatNumber);\r\n//             setSelectedSeats(updatedSeats);\r\n\r\n//         }\r\n\r\n//         return <div>\r\n\r\n//             <div className=\"seat-ul\">\r\n//                 {\r\n//                     allRows.map((row)=>{\r\n\r\n//                         return <div className=\"seat-ul\" >\r\n//                                {\r\n\r\n\r\n//                                 allColumns.map((col)=>{\r\n//                                     let seatNumber = row*columns + col + 1;\r\n//                                     let seatClass = \"seat-btn\";\r\n\r\n//                                     if(showDetails.bookedSeats.includes(seatNumber)){\r\n//                                         seatClass+= \" booked\";\r\n//                                     }\r\n\r\n//                                     if(selectedSeats.includes(seatNumber)){\r\n//                                         seatClass+= \" selected\"\r\n//                                     }\r\n\r\n//                                     if(seatNumber<=totalSeats){\r\n//                                     return <button onClick={()=>handleSeatSelect(seatNumber)}  className={seatClass}> {seatNumber} </button>\r\n//                                     }\r\n//                                 })\r\n//                                }\r\n\r\n//                             </div>\r\n                     \r\n//                     })\r\n//                 }\r\n\r\n//             </div>\r\n\r\n//             <div className=\"bottom-card mt-3 max-width-600 mx-auto\" >\r\n\r\n//                 <div> Selected Seats : <span> {selectedSeats.join(\", \")} </span>  </div>\r\n//                 <div> Total Price : <span> {selectedSeats.length * showDetails.ticketPrice}</span>   </div>\r\n//             </div>\r\n\r\n\r\n//         </div>\r\n\r\n\r\n\r\n\r\n//     }\r\n    \r\n\r\n//     return <>\r\n\r\n//     <Navbar/> \r\n\r\n//     {\r\n//        !showDetails &&  <div className=\"ms-3 pt-3\">\r\n//        <h2> \r\n//            Loading Seat View......\r\n//        </h2>\r\n//    </div>\r\n//     }\r\n\r\n\r\n//     {\r\n//         showDetails && <div>\r\n\r\n//             <Row>\r\n\r\n//                 <Col>\r\n\r\n//                     <Card\r\n//         title= {\r\n\r\n//             <div>\r\n//                 <h1> {showDetails.movie.movieName} </h1>\r\n//                 <p> \r\n//                    {showDetails.theatre.name}, {showDetails.theatre.address}\r\n//                 </p>\r\n//             </div>\r\n\r\n//         }\r\n//         extra={\r\n//             <div>\r\n\r\n//                 <div>\r\n\r\n//                     <h4>  Date : {showDetails.showDate}</h4>\r\n\r\n//                 </div>\r\n\r\n//                 <div>\r\n\r\n//                 <h4>   Time : {showDetails.showTime}</h4>\r\n\r\n//                 </div>\r\n\r\n\r\n//                 <div>\r\n\r\n//                 <h4>  Ticket Price : Rs.{showDetails.ticketPrice}</h4>\r\n\r\n//                 </div>\r\n\r\n\r\n//                 <div>\r\n\r\n//                 <h4>  Total Seats: {showDetails.totalSeats} | Available Seats: \r\n\r\n//                    {showDetails.totalSeats - showDetails.bookedSeats.length}  \r\n                      \r\n//                 </h4>\r\n\r\n//                 </div>\r\n\r\n\r\n//             </div>\r\n\r\n\r\n\r\n//         }\r\n//         style={{\r\n//             width: \"100vw\",\r\n//         }}\r\n//         >\r\n            \r\n//             {getSeats()}\r\n\r\n//         </Card>\r\n                \r\n//                 </Col>\r\n\r\n\r\n//             </Row>\r\n\r\n//             {/* {\r\n\r\n//                 selectedSeats.length >0 && \r\n//                 <StripeCheckout \r\n//                 className=\"ms-3\"\r\n//             token={onToken}\r\n//             stripeKey=\"pk_test_51R3pTx2XhG8Zyja1v8IF4hAfqxkQzaMRAx7e9qgGerT89sUC6uDtGw0AGNQRGqNl0N51UYqzpyzn62VuyIluiDin00xHInuBQv\"\r\n            \r\n//         />\r\n\r\n//             } */}\r\n\r\n\r\n//         </div> \r\n//     }\r\n    \r\n    \r\n//     </>\r\n\r\n// }\r\n\r\n// export default BookShow;\r\n\r\n\r\n\r\n// /*\r\n\r\n//  row=3 col=5 \r\n \r\n//  row * 12 + col + 1\r\n\r\n//  Seat Number = currentRow * TotalCol + currentCol + 1\r\n\r\n\r\n\r\n// */"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAGA;;AAEA;;AAEA;;AAEA;;AAGA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAIA;;AAEA;;AAGA;;AAGA;;AAEA;;AAEA;AACA;;AAEA;;AAGA;;AAEA;;AAEA;AACA;AACA;;AAGA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAGA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAGA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAGA;;AAKA;;AAGA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAGA;;AAEA;;AAEA;;AAGA;;AAEA;;AAEA;;AAEA;;AAEA;;AAGA;;AAIA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAGA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAGA;AACA;;AAGA;;AAEA;;AAEA;;AAIA;;AAEA;;AAEA;;AAEA;;AAIA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}